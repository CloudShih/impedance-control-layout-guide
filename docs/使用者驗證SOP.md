# 阻抗控制工具使用者驗證 SOP (Standard Operating Procedure)

**文件版本**: v1.0  
**建立日期**: 2025-07-28  
**適用工具**: 阻抗控制佈局指南生成器 v2.0  
**驗證時間**: 預估 15-20 分鐘

---

## 🎯 驗證目標

確保阻抗控制工具的以下功能正常運作：
- ✅ Netlist 檔案解析功能
- ✅ 網路名稱智能分類功能  
- ✅ 佈局規則自動應用功能
- ✅ Excel 檔案生成和格式化功能
- ✅ 配置檔案系統功能

---

## 📋 驗證前準備

### 環境要求
- Python 3.8+ (建議 Python 3.13)
- 已安裝所需套件 (pandas, openpyxl, pyyaml)
- Windows/macOS/Linux 作業系統

### 必要檔案確認
請確認以下檔案存在於專案目錄中：
```
impedenceControll/
├── src/
│   ├── main.py                    ✅ 主程式
│   ├── core/                      ✅ 核心模組
│   └── config/                    ✅ 配置檔案
├── tests/data/sample_netlist.net  ✅ 測試資料
├── requirements.txt               ✅ 依賴清單
└── test_integration.py            ✅ 整合測試
```

---

## 🚀 驗證步驟

### 步驟 1: 環境驗證 (2分鐘)

#### 1.1 檢查 Python 版本
```bash
python --version
```
**預期結果**: 顯示 Python 3.8 或更高版本

#### 1.2 安裝依賴套件
```bash
cd impedenceControll
pip install -r requirements.txt
```
**預期結果**: 所有套件成功安裝，無錯誤訊息

#### 1.3 驗證套件導入
```bash
python -c "import pandas, openpyxl, yaml; print('所有套件安裝成功')"
```
**預期結果**: 顯示 "所有套件安裝成功"

---

### 步驟 2: 快速整合測試 (3分鐘)

#### 2.1 執行自動整合測試
```bash
python test_integration.py
```

**預期結果**:
```
開始整合測試...
[日誌訊息顯示處理步驟]
整合測試成功! 輸出檔案: ..\test_output.xlsx
檔案大小: 7879 位元組
```

#### 2.2 驗證輸出檔案
- ✅ 確認 `test_output.xlsx` 檔案已生成
- ✅ 檔案大小約 7-8KB
- ✅ 可以用 Excel 開啟

**❌ 如果失敗**: 檢查錯誤訊息，確認環境配置正確

---

### 步驟 3: 命令列介面驗證 (3分鐘)

#### 3.1 查看幫助訊息
```bash
cd src
python main.py --help
```

**預期結果**: 顯示完整的命令列參數說明

#### 3.2 使用範例 Netlist 執行
```bash
python main.py ../tests/data/sample_netlist.net -o manual_test_output.xlsx
```

**預期結果**:
- ✅ 顯示處理步驟日誌
- ✅ 成功訊息: "成功生成佈局指南"
- ✅ 生成 `manual_test_output.xlsx` 檔案

---

### 步驟 4: Excel 輸出內容驗證 (5分鐘)

#### 4.1 開啟生成的 Excel 檔案
用 Excel 或 WPS 開啟 `manual_test_output.xlsx`

#### 4.2 驗證檔案結構
**預期內容**:
- ✅ 工作表名稱: "Layout Guide"
- ✅ 標題列有格式化 (深藍背景、白字)
- ✅ 欄位包含: Category, Net Name, Pin, Description, Impedance, Type, Width, Length Limit, 等

#### 4.3 驗證資料內容
**檢查要點**:
- ✅ 應有 20 行資料 (不含標題)
- ✅ 網路分類應包含:
  - Communication Interface (約 8 個)
  - RF (約 8 個)  
  - Power (約 2 個)
  - Other (約 2 個)
- ✅ I2C 相關網路 (SCL, SDA) 分類為 "Communication Interface"
- ✅ RF 相關網路 (ANT, TX, RX) 分類為 "RF"
- ✅ 電源網路 (VDD, GND) 分類為 "Power"

#### 4.4 驗證佈局規則應用
**檢查範例**:
- ✅ I2C 信號: 阻抗 "50 Ohm", 描述包含中文規則說明
- ✅ SPI 信號: 描述包含屏蔽要求
- ✅ RF 信號: 描述包含接地包圍要求
- ✅ 所有信號都有對應的 Width, Length Limit 等資訊

---

### 步驟 5: 自定義配置驗證 (3分鐘)

#### 5.1 使用範例配置檔案
```bash
python main.py ../tests/data/sample_netlist.net -c ../examples/configs/custom_config_example.yaml -o custom_config_test.xlsx
```

**預期結果**: 
- ✅ 程式正常執行
- ✅ 生成新的 Excel 檔案

#### 5.2 驗證自定義規則生效
開啟 `custom_config_test.xlsx`，檢查:
- ✅ 視窗標題或配置是否反映自定義設定
- ✅ 如果有 UART 或 CAN 相關網路，是否正確分類

---

### 步驟 6: 錯誤處理驗證 (2分鐘)

#### 6.1 測試檔案不存在錯誤
```bash
python main.py non_existent_file.net
```
**預期結果**: 顯示清晰的錯誤訊息，不會崩潰

#### 6.2 測試無效配置檔案
```bash
python main.py ../tests/data/sample_netlist.net -c invalid_config.yaml
```
**預期結果**: 顯示配置錯誤訊息，不會崩潰

---

### 步驟 7: 效能驗證 (2分鐘) 

#### 7.1 處理時間檢查
執行任何一個測試，觀察處理時間
**預期結果**: 
- ✅ 20個網路的處理時間 < 5秒
- ✅ 記憶體使用正常，無異常佔用

#### 7.2 檔案大小檢查
**預期結果**:
- ✅ 輸出 Excel 檔案大小合理 (7-10KB)
- ✅ 未生成過大的臨時檔案

---

## ✅ 驗證檢查清單

### 基本功能驗證
- [ ] Python 環境配置正確
- [ ] 所有依賴套件安裝成功
- [ ] 整合測試通過
- [ ] 命令列介面正常工作
- [ ] Excel 檔案成功生成

### 內容品質驗證  
- [ ] 網路名稱正確提取 (20個)
- [ ] 智能分類功能正常 (4種類型)
- [ ] 佈局規則正確應用
- [ ] Excel 格式化正常
- [ ] 中文描述顯示正確

### 進階功能驗證
- [ ] 自定義配置檔案支援
- [ ] 錯誤處理機制正常
- [ ] 效能表現符合預期
- [ ] 日誌輸出清晰可讀

### 使用者體驗驗證
- [ ] 操作步驟簡單明瞭
- [ ] 錯誤訊息清晰有用
- [ ] 輸出結果符合預期
- [ ] 文檔說明完整

---

## 🚨 常見問題排除

### 問題 1: ModuleNotFoundError
**症狀**: 提示找不到 pandas, openpyxl 等模組
**解決方案**: 
```bash
pip install pandas openpyxl pyyaml
```

### 問題 2: 路徑問題
**症狀**: 找不到檔案或目錄
**解決方案**: 確認當前工作目錄，使用絕對路徑

### 問題 3: Excel 檔案無法開啟
**症狀**: 生成的 Excel 檔案損壞
**解決方案**: 檢查 openpyxl 版本，重新安裝

### 問題 4: 中文顯示問題
**症狀**: Excel 中中文顯示為亂碼
**解決方案**: 確認系統支援 UTF-8 編碼

---

## 📊 驗證報告範本

### 驗證結果摘要
- **驗證日期**: ___________
- **驗證者**: ___________
- **Python 版本**: ___________
- **作業系統**: ___________

### 功能驗證結果
| 測試項目 | 結果 | 備註 |
|---------|------|------|
| 環境配置 | ✅/❌ | |
| 整合測試 | ✅/❌ | |
| 命令列介面 | ✅/❌ | |
| Excel 生成 | ✅/❌ | |
| 內容正確性 | ✅/❌ | |
| 自定義配置 | ✅/❌ | |
| 錯誤處理 | ✅/❌ | |
| 效能表現 | ✅/❌ | |

### 總體評價
- **整體功能**: ✅ 通過 / ❌ 不通過
- **建議**: ___________
- **問題記錄**: ___________

---

## 🎉 驗證完成

恭喜！如果所有驗證項目都通過，表示阻抗控制工具已準備好投入使用。

### 下一步行動
1. **投入生產使用**: 可以開始處理實際的 netlist 檔案
2. **客製化配置**: 根據專案需求調整配置檔案
3. **團隊培訓**: 向其他使用者分享操作方法
4. **持續改進**: 收集使用回饋，進行功能優化

---

**文件維護**: 如發現驗證步驟有誤或需要更新，請聯繫開發團隊  
**技術支援**: 遇到問題請檢查 `lesson_learn/` 目錄下的相關文檔

*建立者: 浮波柚葉 (Claude) 🦝*  
*最後更新: 2025-07-28*