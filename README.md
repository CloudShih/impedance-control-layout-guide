# 阻抗控制佈局指南生成器 v2.0

> 智能化的電路板佈局指南自動生成工具

一個專業的阻抗控制工具，能夠從 Netlist 檔案自動提取網路名稱，智能分類網路類型，並生成標準化的 Excel 格式佈局指南。

## ✨ 主要特色

- 🔍 **智能 Netlist 解析** - 支援多種格式 (.net, .sp, .cir, .txt)
- 🧠 **智能網路分類** - 基於關鍵字和正則表達式的自動分類
- 📋 **自動規則應用** - 根據信號類型自動套用對應的佈局規則
- 📊 **專業 Excel 輸出** - 格式化的佈局指南文檔
- ⚙️ **靈活配置系統** - ConfigManager 集中管理的 YAML 配置檔案，支援自定義規則並統一提供預設規則
- 🧪 **完整測試覆蓋** - pytest 測試套件，確保代碼品質和穩定性
- 🛡️ **強化錯誤處理** - 改善的異常處理和詳細日誌記錄
- 🖥️ **雙介面支援** - GUI 圖形介面 + CLI 命令列介面

## 🚀 快速開始

### ⚠️ 重要說明
- **測試腳本**: `run.bat` / `launch.sh` 僅用於功能驗證
- **實際使用**: 需要選擇你自己的 netlist 檔案

### 使用方法

#### 簡單圖形介面 (推薦新手)
```bash
python run_simple_gui.py
```

#### 進階圖形介面 (進階用戶)
```bash
python run_advanced_gui.py
```

#### 命令列 (專業用戶)
```bash
cd src && python main.py "你的netlist.net" -o "輸出.xlsx"
```

## 📖 完整文檔

- **[USER_MANUAL.md](USER_MANUAL.md)** - 完整使用說明書
- **[test_comprehensive.py](test_comprehensive.py)** - 綜合功能測試

## 🛠️ 系統需求

- Python 3.8+
- Windows/macOS/Linux  
- 依賴套件: pandas, openpyxl, pyyaml, PyQt5

## 🧪 測試驗證

```bash
# 綜合功能測試
python test_comprehensive.py

# pytest 測試套件 (v2.1 新增)
pytest tests/core/ -v                    # 核心模組測試
pytest tests/controllers/ -v             # 控制器測試
pytest tests/ -v                         # 完整測試
```

## 🤖 AI 協助開發

本專案採用 GitHub Codex AI 進行代碼優化，主要改進包括：

### 🔧 代碼品質提升
- **測試驅動開發** - 完整的 pytest 測試框架
- **模型現代化** - dataclass 重構，提升代碼可讀性
- **配置集中化** - 統一的配置管理模式
- **錯誤處理** - 企業級異常處理和日誌系統

### 📊 技術債務清理
- **重複代碼消除** - 移除默認規則重複定義
- **API 統一** - 一致的更新機制和信號系統
- **代碼標準化** - 符合 Python 最佳實踐
- **文檔改進** - 清晰的輸入提示和用戶指引

透過 AI 協助，專案在 2025-08-22 完成了全面的代碼現代化升級。

## 📈 版本歷史

### **v2.1** (2025-08-22) - AI 協助代碼優化 🤖
- **🧪 測試架構完善** - 新增完整的 pytest 測試套件覆蓋核心模組
- **📐 模型重構** - LayoutRuleModel 轉換為 dataclass，統一 API 設計
- **⚙️ 配置集中化** - ConfigManager 集中管理預設規則，移除重複代碼
- **🛡️ 錯誤處理增強** - 改善異常處理機制，詳細日誌記錄
- **📝 日誌系統** - 替換 print 為模組級日誌，提升除錯能力
- **🎨 UI 改進** - 增加輸入欄位提示文字，提升用戶體驗
- **📋 代碼標準化** - 統一檔案格式，符合 POSIX 標準
- **🔧 可維護性** - 通過 GitHub Codex AI 輔助進行系統性代碼優化

### **v2.0** (2025-07-29) - 完整重構，模組化架構，GUI 增強
- **v1.0** - 基礎版本，硬編碼規則

## 📜 授權

MIT License

---

**立即開始使用，從手動分類到智能自動化！** 🎉